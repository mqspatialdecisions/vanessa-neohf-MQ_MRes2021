---
title: "Degree Heating Week Analysis"
author: "Vanessa"
date: "`r lubridate::today()`"
output: pdf_document
editor_options: 
  chunk_output_type: console
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r Loading Packages, message = FALSE, include = FALSE}
library(tidyverse)
library(lubridate)
library(dplyr)
library(patchwork)
library(colorspace)
library(rmarkdown)
library(kableExtra)
```

```{r Reading CCI & NOAA Degree Heating Week Raw Data, include = FALSE}
#CCI data
CCI_BRS05 <- read_csv(here::here("data_raw", "CCI_BRS05_with_mmm_and_dhw.csv"))
CCI_BRS07 <- read_csv(here::here("data_raw", "CCI_BRS07_with_mmm_and_dhw.csv"))
CCI_BUN05A <- read_csv(here::here("data_raw", "CCI_BUN05A_with_mmm_and_dhw.csv"))
CCI_Bundegi <- read_csv(here::here("data_raw", "CCI_Bundegi_with_mmm_and_dhw.csv"))
CCI_DAR3 <- read_csv(here::here("data_raw", "CCI_DAR3_with_mmm_and_dhw.csv"))
CCI_DARL <- read_csv(here::here("data_raw", "CCI_DARL_with_mmm_and_dhw.csv"))
CCI_HAB05B <- read_csv(here::here("data_raw", "CCI_HAB05B_with_mmm_and_dhw.csv"))
CCI_HAB10A <- read_csv(here::here("data_raw", "CCI_HAB10A_with_mmm_and_dhw.csv"))
CCI_SCOTT_RPO_1 <- read_csv(here::here("data_raw", "CCI_SCOTT_RPO_1_with_mmm_and_dhw.csv"))
CCI_SCOTT_SL4 <- read_csv(here::here("data_raw", "CCI_SCOTT_SL4_with_mmm_and_dhw.csv"))
CCI_SCOTT_SS3 <- read_csv(here::here("data_raw", "CCI_SCOTT_SS3_with_mmm_and_dhw.csv"))
CCI_SCOTTNR1 <- read_csv(here::here("data_raw", "CCI_SCOTTNR1_with_mmm_and_dhw.csv"))
CCI_SCOTTSL1 <- read_csv(here::here("data_raw", "CCI_SCOTTSL1_with_mmm_and_dhw.csv"))
CCI_SCOTTSL2 <- read_csv(here::here("data_raw", "CCI_SCOTTSL2_with_mmm_and_dhw.csv"))
CCI_SCOTTSL3 <- read_csv(here::here("data_raw", "CCI_SCOTTSL3_with_mmm_and_dhw.csv"))
CCI_SCOTTSS1 <- read_csv(here::here("data_raw", "CCI_SCOTTSS1_with_mmm_and_dhw.csv"))
CCI_SCOTTSS2 <- read_csv(here::here("data_raw", "CCI_SCOTTSS2_with_mmm_and_dhw.csv"))
CCI_Tantabiddi <- read_csv(here::here("data_raw", "CCI_Tantabiddi_with_mmm_and_dhw.csv"))
CCI_TNT <- read_csv(here::here("data_raw", "CCI_TNT_with_mmm_and_dhw.csv"))
CCI_TNT07C <- read_csv(here::here("data_raw", "CCI_TNT07C_with_mmm_and_dhw.csv"))
CCI_Wallabi_Island <- read_csv(here::here("data_raw", "CCI_Wallabi_Island_with_mmm_and_dhw.csv"))

#NOAA data
NOAA_BRS05 <- read_csv(here::here("data_raw", "NOAA_BRS05_with_mmm_and_dhw.csv"))
NOAA_BRS07 <- read_csv(here::here("data_raw", "NOAA_BRS07_with_mmm_and_dhw.csv"))
NOAA_BUN05A <- read_csv(here::here("data_raw", "NOAA_BUN05A_with_mmm_and_dhw.csv"))
NOAA_Bundegi <- read_csv(here::here("data_raw", "NOAA_Bundegi_with_mmm_and_dhw.csv"))
NOAA_DAR3 <- read_csv(here::here("data_raw", "NOAA_DAR3_with_mmm_and_dhw.csv"))
NOAA_DARL <- read_csv(here::here("data_raw", "NOAA_DAR_Long_with_mmm_and_dhw.csv"))
NOAA_HAB05B <- read_csv(here::here("data_raw", "NOAA_SST_HAB05B_SrCa_with_mmm_and_dhw.csv"))
NOAA_HAB10A <- read_csv(here::here("data_raw", "NOAA_SST_HAB10A_SrCa_with_mmm_and_dhw.csv"))
NOAA_SCOTT_RPO_1 <- read_csv(here::here("data_raw", "NOAA_SCOTT_RPO_1_with_mmm_and_dhw.csv"))
NOAA_SCOTT_SL4 <- read_csv(here::here("data_raw", "NOAA_SCOTT_SL4_with_mmm_and_dhw.csv"))
NOAA_SCOTT_SS3 <- read_csv(here::here("data_raw", "NOAA_SCOTT_SS3_with_mmm_and_dhw.csv"))
NOAA_SCOTTNR1 <- read_csv(here::here("data_raw", "NOAA_SCOTTNR1_with_mmm_and_dhw.csv"))
NOAA_SCOTTSL1 <- read_csv(here::here("data_raw", "NOAA_SCOTTSL1_with_mmm_and_dhw.csv"))
NOAA_SCOTTSL2 <- read_csv(here::here("data_raw", "NOAA_SCOTTSL2_with_mmm_and_dhw.csv"))
NOAA_SCOTTSL3 <- read_csv(here::here("data_raw", "NOAA_SCOTTSL3_with_mmm_and_dhw.csv"))
NOAA_SCOTTSS1 <- read_csv(here::here("data_raw", "NOAA_SCOTTSS1_with_mmm_and_dhw.csv"))
NOAA_SCOTTSS2 <- read_csv(here::here("data_raw", "NOAA_SCOTTSS2_with_mmm_and_dhw.csv"))
NOAA_Tantabiddi <- read_csv(here::here("data_raw", "NOAA_Tantabiddi_with_mmm_and_dhw.csv"))
NOAA_TNT <- read_csv(here::here("data_raw", "NOAA_TNT_with_mmm_and_dhw.csv"))
NOAA_TNT07C <- read_csv(here::here("data_raw", "NOAA_TNT07C_with_mmm_and_dhw.csv"))
NOAA_Wallabi_Island <- read_csv(here::here("data_raw", "NOAA_Wallabi_Island_with_mmm_and_dhw.csv"))

#GCM data
GCM_BRS05 <- read_csv(here::here("data_raw/GCM", "GCM_BRS05_with_mmm_and_dhw.csv"))
GCM_BRS07 <- read_csv(here::here("data_raw/GCM", "GCM_BRS07_with_mmm_and_dhw.csv"))
GCM_BUN05A <- read_csv(here::here("data_raw/GCM", "GCM_BUN05A_with_mmm_and_dhw.csv"))
GCM_Bundegi <- read_csv(here::here("data_raw/GCM", "GCM_Bundegi_with_mmm_and_dhw.csv"))
GCM_Tantabiddi <- read_csv(here::here("data_raw/GCM", "GCM_Tantabiddi_with_mmm_and_dhw.csv"))
GCM_TNT07C <- read_csv(here::here("data_raw/GCM", "GCM_TNT07C_with_mmm_and_dhw.csv"))
GCM_DARL <- read_csv(here::here("data_raw/GCM", "GCM_DAR_Long_with_mmm_and_dhw.csv"))
GCM_DAR3 <- read_csv(here::here("data_raw/GCM", "GCM_DAR3_with_mmm_and_dhw.csv"))
GCM_HAB05B <- read_csv(here::here("data_raw/GCM", "GCM_HAB05B_with_mmm_and_dhw.csv"))
GCM_HAB10A <- read_csv(here::here("data_raw/GCM", "GCM_HAB10A_with_mmm_and_dhw.csv"))
GCM_SCOTT_RPO_1 <- read_csv(here::here("data_raw/GCM", "GCM_SCOTT_RPO_1_with_mmm_and_dhw.csv"))
GCM_SCOTT_SL4 <- read_csv(here::here("data_raw/GCM", "GCM_SCOTT_SL4_with_mmm_and_dhw.csv"))
GCM_SCOTT_SS3 <- read_csv(here::here("data_raw/GCM", "GCM_SCOTT_SS3_with_mmm_and_dhw.csv"))
GCM_SCOTTNR1 <- read_csv(here::here("data_raw/GCM", "GCM_SCOTTNR1_with_mmm_and_dhw.csv"))
GCM_SCOTTSL1 <- read_csv(here::here("data_raw/GCM", "GCM_SCOTTSL1_with_mmm_and_dhw.csv"))
GCM_SCOTTSL2 <- read_csv(here::here("data_raw/GCM", "GCM_SCOTTSL2_with_mmm_and_dhw.csv"))
GCM_SCOTTSL3 <- read_csv(here::here("data_raw/GCM", "GCM_SCOTTSL3_with_mmm_and_dhw.csv"))
GCM_SCOTTSS1 <- read_csv(here::here("data_raw/GCM", "GCM_SCOTTSS1_with_mmm_and_dhw.csv"))
GCM_SCOTTSS2 <- read_csv(here::here("data_raw/GCM", "GCM_SCOTTSS2_with_mmm_and_dhw.csv"))
```


# Degree Heating Week Time Series Plots for CCI and NOAA data:      



```{r DHW_TS, echo = FALSE}
#CCI and NOAA data were first checked for duplicate dates using sum(duplicated(<dataset>$Date)) and no duplicates were ensured

#BRS05
CCI_BRS05 <- CCI_BRS05 %>% 
  mutate(Reef_Site = "BRS05", Data_Type = "CCI") %>% 
  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

NOAA_BRS05 <- NOAA_BRS05 %>% 
  mutate(Data_Type = "NOAA") %>% 
  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

GCM_BRS05 <- GCM_BRS05 %>% 
  mutate(Reef_Site = "BRS05", Data_Type = "GCM") %>% 
  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

BRS05_Sat_Combined <- rbind(CCI_BRS05, NOAA_BRS05, GCM_BRS05)

ggplot(BRS05_Sat_Combined)+
  geom_rect(aes_string(xmin = as.Date(c("2015-06-01")), xmax = as.Date(c("2017-06-01")),
                ymin = -Inf, ymax = Inf), color = "maroon", fill = "transparent", alpha = 0.5)+
  geom_line(aes(x = Date, y = accum_DHW_12weeks, color = Data_Type), alpha = 0.3, size = 2) +
  labs(x = "Time", y = "DHW value", title = "Time Series of BRS05 (-14.11, 123.54) Degree Heating Week values") +
  scale_color_discrete_qualitative(name = "Satellite") +
  scale_y_continuous(breaks = c(0, 4, 8, 12, 16, 20)) +
  theme(panel.grid.major.y = element_line(color = "grey", linetype = "dashed"),
        legend.key = element_rect(fill = "transparent"),
        plot.title = element_text( face = "bold")
  )


#BRS07
CCI_BRS07 <- CCI_BRS07 %>% 
  mutate(Reef_Site = "BRS07", Data_Type = "CCI") %>% 
  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

NOAA_BRS07 <- NOAA_BRS07 %>% 
  mutate(Data_Type = "NOAA") %>% 
  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

GCM_BRS07 <- GCM_BRS07 %>% 
  mutate(Reef_Site = "BRS07", Data_Type = "GCM") %>% 
  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

BRS07_Sat_Combined <- rbind(CCI_BRS07, NOAA_BRS07, GCM_BRS07)

ggplot(BRS07_Sat_Combined)+
   geom_rect(aes_string(xmin = as.Date(c("2015-06-01")), xmax = as.Date(c("2017-06-01")),
                ymin = -Inf, ymax = Inf), color = "maroon", fill = "transparent", alpha = 0.5)+
  geom_line(aes(x = Date, y = accum_DHW_12weeks, color = Data_Type), alpha = 0.3, size = 2) +
  labs(x = "Time", y = "DHW value", title = "Time Series of BRS07 (-14.12, 123.55) Degree Heating Week values") +
  scale_color_discrete_qualitative(name = "Satellite") +
  scale_y_continuous(breaks = c(0, 4, 8, 12, 16, 20)) +
  theme(panel.grid.major.y = element_line(color = "grey", linetype = "dashed"),
        legend.key = element_rect(fill = "transparent"),
        plot.title = element_text( face = "bold")
  )


#DAR3
CCI_DAR3 <- CCI_DAR3 %>% 
  mutate(Reef_Site = "DAR3", Data_Type = "CCI") %>% 
  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

NOAA_DAR3 <- NOAA_DAR3 %>% 
  mutate(Data_Type = "NOAA") %>% 
  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

GCM_DAR3 <- GCM_DAR3 %>% 
  mutate(Reef_Site = "DAR3", Data_Type = "GCM") %>% 
  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

DAR3_Sat_Combined <- rbind(CCI_DAR3, NOAA_DAR3, GCM_DAR3)

ggplot(DAR3_Sat_Combined)+
  geom_rect(aes_string(xmin = as.Date(c("1995-06-01")), xmax = as.Date(c("1997-06-01")),
                ymin = -Inf, ymax = Inf), color = "blue", fill = "transparent", alpha = 0.5)+
   geom_rect(aes_string(xmin = as.Date(c("1997-06-01")), xmax = as.Date(c("1999-06-01")),
                ymin = -Inf, ymax = Inf), color = "blue", fill = "transparent", alpha = 0.5)+
  geom_rect(aes_string(xmin = as.Date(c("2013-06-01")), xmax = as.Date(c("2015-06-01")),
                ymin = -Inf, ymax = Inf), color = "blue", fill = "transparent", alpha = 0.5)+
   geom_rect(aes_string(xmin = as.Date(c("2015-06-01")), xmax = as.Date(c("2017-06-01")),
                ymin = -Inf, ymax = Inf), color = "blue", fill = "transparent", alpha = 0.5)+
  geom_line(aes(x = Date, y = accum_DHW_12weeks, color = Data_Type), alpha = 0.3, size = 2) +
  labs(x = "Time", y = "DHW value", title = "Time Series of DAR3 (-12.10, 96.88) Degree Heating Week values") +
  scale_color_discrete_qualitative(name = "Satellite") +
  scale_y_continuous(breaks = c(0, 4, 8, 12, 16, 20)) +
  theme(panel.grid.major.y = element_line(color = "grey", linetype = "dashed"),
        legend.key = element_rect(fill = "transparent"),
        plot.title = element_text( face = "bold")
  )


#DAR Long
CCI_DARL <- CCI_DARL %>% 
  mutate(Reef_Site = "DAR Long", Data_Type = "CCI") %>% 
  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

NOAA_DARL <- NOAA_DARL %>% 
  mutate(Data_Type = "NOAA") %>% 
  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

GCM_DARL <- GCM_DARL %>% 
  mutate(Reef_Site = "DAR Long", Data_Type = "GCM") %>% 
  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

DARL_Sat_Combined <- rbind(CCI_DARL, NOAA_DARL, GCM_DARL)

ggplot(DARL_Sat_Combined)+
  geom_rect(aes_string(xmin = as.Date(c("1995-06-01")), xmax = as.Date(c("1997-06-01")),
                ymin = -Inf, ymax = Inf), color = "blue", fill = "transparent", alpha = 0.5)+
   geom_rect(aes_string(xmin = as.Date(c("1997-06-01")), xmax = as.Date(c("1999-06-01")),
                ymin = -Inf, ymax = Inf), color = "blue", fill = "transparent", alpha = 0.5)+
  geom_rect(aes_string(xmin = as.Date(c("2013-06-01")), xmax = as.Date(c("2015-06-01")),
                ymin = -Inf, ymax = Inf), color = "blue", fill = "transparent", alpha = 0.5)+
   geom_rect(aes_string(xmin = as.Date(c("2015-06-01")), xmax = as.Date(c("2017-06-01")),
                ymin = -Inf, ymax = Inf), color = "blue", fill = "transparent", alpha = 0.5)+
  geom_line(aes(x = Date, y = accum_DHW_12weeks, color = Data_Type), alpha = 0.3, size = 2) +
  labs(x = "Time", y = "DHW value", title = "Time Series of DAR Long (-12.09, 96.88) Degree Heating Week values") +
  scale_color_discrete_qualitative(name = "Satellite") +
  scale_y_continuous(breaks = c(0, 4, 8, 12, 16, 20)) +
  theme(panel.grid.major.y = element_line(color = "grey", linetype = "dashed"),
        legend.key = element_rect(fill = "transparent"),
        plot.title = element_text( face = "bold")
  )


#Scott_RPO_1
CCI_SCOTT_RPO_1 <- CCI_SCOTT_RPO_1 %>% 
  mutate(Reef_Site = "SCOTT_RPO_1", Data_Type = "CCI") %>% 
  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

NOAA_SCOTT_RPO_1 <- NOAA_SCOTT_RPO_1 %>% 
  mutate(Data_Type = "NOAA", Reef_Site = subsite) %>% 
  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

GCM_SCOTT_RPO_1 <- GCM_SCOTT_RPO_1 %>% 
  mutate(Reef_Site = "SCOTT_RPO_1", Data_Type = "GCM") %>% 
  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

SCOTT_RPO_1_Sat_Combined <- rbind(CCI_SCOTT_RPO_1, NOAA_SCOTT_RPO_1, GCM_SCOTT_RPO_1)

ggplot(SCOTT_RPO_1_Sat_Combined)+
  geom_rect(aes_string(xmin = as.Date(c("1997-06-01")), xmax = as.Date(c("1999-06-01")),
                ymin = -Inf, ymax = Inf), color = "maroon", fill = "transparent", alpha = 0.5)+
   geom_rect(aes_string(xmin = as.Date(c("2010-06-01")), xmax = as.Date(c("2012-06-01")),
                ymin = -Inf, ymax = Inf), color = "blue", fill = "transparent", alpha = 0.5)+
  geom_rect(aes_string(xmin = as.Date(c("2012-06-01")), xmax = as.Date(c("2014-06-01")),
                ymin = -Inf, ymax = Inf), color = "blue", fill = "transparent", alpha = 0.5)+
   geom_rect(aes_string(xmin = as.Date(c("2015-06-01")), xmax = as.Date(c("2017-06-01")),
                ymin = -Inf, ymax = Inf), color = "maroon", fill = "transparent", alpha = 0.5)+
  geom_line(aes(x = Date, y = accum_DHW_12weeks, color = Data_Type), alpha = 0.3, size = 2) +
  geom_line(aes(x = Date, y = accum_DHW_12weeks, color = Data_Type), alpha = 0.3, size = 2) +
  labs(x = "Time", y = "DHW value", title = "Time Series of SCOTT_RPO_1 (-14.06, 121.78) Degree Heating Week values") +
  scale_color_discrete_qualitative(name = "Satellite") +
  scale_y_continuous(breaks = c(0, 4, 8, 12, 16, 20)) +
  theme(panel.grid.major.y = element_line(color = "grey", linetype = "dashed"),
        legend.key = element_rect(fill = "transparent"),
        plot.title = element_text( face = "bold")
  )


#Scott_SL4
CCI_SCOTT_SL4 <- CCI_SCOTT_SL4 %>% 
  mutate(Reef_Site = "SCOTT_SL4", Data_Type = "CCI") %>% 
  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

NOAA_SCOTT_SL4 <- NOAA_SCOTT_SL4 %>% 
  mutate(Data_Type = "NOAA", Reef_Site = subsite) %>% 
  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

GCM_SCOTT_SL4 <- GCM_SCOTT_SL4 %>% 
  mutate(Reef_Site = "SCOTT_SL4", Data_Type = "GCM") %>% 
  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

SCOTT_SL4_Sat_Combined <- rbind(CCI_SCOTT_SL4, NOAA_SCOTT_SL4, GCM_SCOTT_SL4)

ggplot(SCOTT_SL4_Sat_Combined)+
  geom_rect(aes_string(xmin = as.Date(c("1997-06-01")), xmax = as.Date(c("1999-06-01")),
                ymin = -Inf, ymax = Inf), color = "maroon", fill = "transparent", alpha = 0.5)+
   geom_rect(aes_string(xmin = as.Date(c("2010-06-01")), xmax = as.Date(c("2012-06-01")),
                ymin = -Inf, ymax = Inf), color = "blue", fill = "transparent", alpha = 0.5)+
  geom_rect(aes_string(xmin = as.Date(c("2012-06-01")), xmax = as.Date(c("2014-06-01")),
                ymin = -Inf, ymax = Inf), color = "blue", fill = "transparent", alpha = 0.5)+
   geom_rect(aes_string(xmin = as.Date(c("2015-06-01")), xmax = as.Date(c("2017-06-01")),
                ymin = -Inf, ymax = Inf), color = "maroon", fill = "transparent", alpha = 0.5)+
  geom_line(aes(x = Date, y = accum_DHW_12weeks, color = Data_Type), alpha = 0.3, size = 2) +
  labs(x = "Time", y = "DHW value", title = "Time Series of SCOTT_SL4 (-14.02, 121.86) Degree Heating Week values") +
  scale_color_discrete_qualitative(name = "Satellite") +
  scale_y_continuous(breaks = c(0, 4, 8, 12, 16, 20)) +
  theme(panel.grid.major.y = element_line(color = "grey", linetype = "dashed"),
        legend.key = element_rect(fill = "transparent"),
        plot.title = element_text( face = "bold")
  )
  

#Scott_SS3
CCI_SCOTT_SS3 <- CCI_SCOTT_SS3 %>% 
  mutate(Reef_Site = "SCOTT_SS3", Data_Type = "CCI") %>% 
  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

NOAA_SCOTT_SS3 <- NOAA_SCOTT_SS3 %>% 
  mutate(Data_Type = "NOAA", Reef_Site = subsite) %>% 
  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

GCM_SCOTT_SS3 <- GCM_SCOTT_SS3 %>% 
  mutate(Reef_Site = "SCOTT_SS3", Data_Type = "GCM") %>% 
  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

SCOTT_SS3_Sat_Combined <- rbind(CCI_SCOTT_SS3, NOAA_SCOTT_SS3, GCM_SCOTT_SS3)

ggplot(SCOTT_SS3_Sat_Combined)+
  geom_rect(aes_string(xmin = as.Date(c("1997-06-01")), xmax = as.Date(c("1999-06-01")),
                ymin = -Inf, ymax = Inf), color = "maroon", fill = "transparent", alpha = 0.5)+
   geom_rect(aes_string(xmin = as.Date(c("2010-06-01")), xmax = as.Date(c("2012-06-01")),
                ymin = -Inf, ymax = Inf), color = "blue", fill = "transparent", alpha = 0.5)+
  geom_rect(aes_string(xmin = as.Date(c("2012-06-01")), xmax = as.Date(c("2014-06-01")),
                ymin = -Inf, ymax = Inf), color = "blue", fill = "transparent", alpha = 0.5)+
   geom_rect(aes_string(xmin = as.Date(c("2015-06-01")), xmax = as.Date(c("2017-06-01")),
                ymin = -Inf, ymax = Inf), color = "maroon", fill = "transparent", alpha = 0.5)+
  geom_line(aes(x = Date, y = accum_DHW_12weeks, color = Data_Type), alpha = 0.3, size = 2) +
  labs(x = "Time", y = "DHW value", title = "Time Series of SCOTT_SS3 (-13.64, 122.03) Degree Heating Week values") +
  scale_color_discrete_qualitative(name = "Satellite") +
  scale_y_continuous(breaks = c(0, 4, 8, 12, 16, 20)) +
  theme(panel.grid.major.y = element_line(color = "grey", linetype = "dashed"),
        legend.key = element_rect(fill = "transparent"),
        plot.title = element_text( face = "bold")
  )


#ScottNR1
CCI_SCOTTNR1 <- CCI_SCOTTNR1 %>% 
  mutate(Reef_Site = "SCOTTNR1", Data_Type = "CCI") %>% 
  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

NOAA_SCOTTNR1 <- NOAA_SCOTTNR1 %>% 
  mutate(Data_Type = "NOAA", Reef_Site = subsite) %>% 
  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

GCM_SCOTTNR1 <- GCM_SCOTTNR1 %>% 
  mutate(Reef_Site = "SCOTTNR1", Data_Type = "GCM") %>% 
  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

SCOTTNR1_Sat_Combined <- rbind(CCI_SCOTTNR1, NOAA_SCOTTNR1, GCM_SCOTTNR1)

ggplot(SCOTTNR1_Sat_Combined)+
  geom_rect(aes_string(xmin = as.Date(c("1997-06-01")), xmax = as.Date(c("1999-06-01")),
                ymin = -Inf, ymax = Inf), color = "maroon", fill = "transparent", alpha = 0.5)+
   geom_rect(aes_string(xmin = as.Date(c("2010-06-01")), xmax = as.Date(c("2012-06-01")),
                ymin = -Inf, ymax = Inf), color = "blue", fill = "transparent", alpha = 0.5)+
  geom_rect(aes_string(xmin = as.Date(c("2012-06-01")), xmax = as.Date(c("2014-06-01")),
                ymin = -Inf, ymax = Inf), color = "blue", fill = "transparent", alpha = 0.5)+
   geom_rect(aes_string(xmin = as.Date(c("2015-06-01")), xmax = as.Date(c("2017-06-01")),
                ymin = -Inf, ymax = Inf), color = "maroon", fill = "transparent", alpha = 0.5)+
  geom_line(aes(x = Date, y = accum_DHW_12weeks, color = Data_Type), alpha = 0.3, size = 2) +
  labs(x = "Time", y = "DHW value", title = "Time Series of SCOTTNR1 (-13.99, 121.88) Degree Heating Week values") +
  scale_color_discrete_qualitative(name = "Satellite") +
  scale_y_continuous(breaks = c(0, 4, 8, 12, 16, 20)) +
  theme(panel.grid.major.y = element_line(color = "grey", linetype = "dashed"),
        legend.key = element_rect(fill = "transparent"),
        plot.title = element_text( face = "bold")
  )


#ScottSL1
CCI_SCOTTSL1 <- CCI_SCOTTSL1 %>% 
  mutate(Reef_Site = "SCOTTSL1", Data_Type = "CCI") %>% 
  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

NOAA_SCOTTSL1 <- NOAA_SCOTTSL1 %>% 
  mutate(Data_Type = "NOAA", Reef_Site = subsite) %>% 
  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

GCM_SCOTTSL1 <- GCM_SCOTTSL1 %>% 
  mutate(Reef_Site = "SCOTTSL1", Data_Type = "GCM") %>% 
  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

SCOTTSL1_Sat_Combined <- rbind(CCI_SCOTTSL1, NOAA_SCOTTSL1, GCM_SCOTTSL1)

ggplot(SCOTTSL1_Sat_Combined)+
  geom_rect(aes_string(xmin = as.Date(c("1997-06-01")), xmax = as.Date(c("1999-06-01")),
                ymin = -Inf, ymax = Inf), color = "maroon", fill = "transparent", alpha = 0.5)+
   geom_rect(aes_string(xmin = as.Date(c("2010-06-01")), xmax = as.Date(c("2012-06-01")),
                ymin = -Inf, ymax = Inf), color = "blue", fill = "transparent", alpha = 0.5)+
  geom_rect(aes_string(xmin = as.Date(c("2012-06-01")), xmax = as.Date(c("2014-06-01")),
                ymin = -Inf, ymax = Inf), color = "blue", fill = "transparent", alpha = 0.5)+
   geom_rect(aes_string(xmin = as.Date(c("2015-06-01")), xmax = as.Date(c("2017-06-01")),
                ymin = -Inf, ymax = Inf), color = "maroon", fill = "transparent", alpha = 0.5)+
  geom_line(aes(x = Date, y = accum_DHW_12weeks, color = Data_Type), alpha = 0.3, size = 2) +
  labs(x = "Time", y = "DHW value", title = "Time Series of SCOTTSL1 (-14.08, 121.95) Degree Heating Week values") +
  scale_color_discrete_qualitative(name = "Satellite") +
  scale_y_continuous(breaks = c(0, 4, 8, 12, 16, 20)) +
  theme(panel.grid.major.y = element_line(color = "grey", linetype = "dashed"),
        legend.key = element_rect(fill = "transparent"),
        plot.title = element_text( face = "bold")
  )


#ScottSL2
CCI_SCOTTSL2 <- CCI_SCOTTSL2 %>% 
  mutate(Reef_Site = "SCOTTSL2", Data_Type = "CCI") %>% 
  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

NOAA_SCOTTSL2 <- NOAA_SCOTTSL2 %>% 
  mutate(Data_Type = "NOAA", Reef_Site = subsite) %>% 
  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

GCM_SCOTTSL2 <- GCM_SCOTTSL2 %>% 
  mutate(Reef_Site = "SCOTTSL2", Data_Type = "GCM") %>% 
  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

SCOTTSL2_Sat_Combined <- rbind(CCI_SCOTTSL2, NOAA_SCOTTSL2, GCM_SCOTTSL2)

ggplot(SCOTTSL2_Sat_Combined)+
  geom_rect(aes_string(xmin = as.Date(c("1997-06-01")), xmax = as.Date(c("1999-06-01")),
                ymin = -Inf, ymax = Inf), color = "maroon", fill = "transparent", alpha = 0.5)+
   geom_rect(aes_string(xmin = as.Date(c("2010-06-01")), xmax = as.Date(c("2012-06-01")),
                ymin = -Inf, ymax = Inf), color = "blue", fill = "transparent", alpha = 0.5)+
  geom_rect(aes_string(xmin = as.Date(c("2012-06-01")), xmax = as.Date(c("2014-06-01")),
                ymin = -Inf, ymax = Inf), color = "blue", fill = "transparent", alpha = 0.5)+
   geom_rect(aes_string(xmin = as.Date(c("2015-06-01")), xmax = as.Date(c("2017-06-01")),
                ymin = -Inf, ymax = Inf), color = "maroon", fill = "transparent", alpha = 0.5)+
  geom_line(aes(x = Date, y = accum_DHW_12weeks, color = Data_Type), alpha = 0.3, size = 2) +
  labs(x = "Time", y = "DHW value", title = "Time Series of SCOTTSL2 (-14.19, 121.80) Degree Heating Week values") +
  scale_color_discrete_qualitative(name = "Satellite") +
  scale_y_continuous(breaks = c(0, 4, 8, 12, 16, 20)) +
  theme(panel.grid.major.y = element_line(color = "grey", linetype = "dashed"),
        legend.key = element_rect(fill = "transparent"),
        plot.title = element_text( face = "bold")
  )


#ScottSL3
CCI_SCOTTSL3 <- CCI_SCOTTSL3 %>% 
  mutate(Reef_Site = "SCOTTSL3", Data_Type = "CCI") %>% 
  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

NOAA_SCOTTSL3 <- NOAA_SCOTTSL3 %>% 
  mutate(Data_Type = "NOAA", Reef_Site = subsite) %>% 
  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

GCM_SCOTTSL3 <- GCM_SCOTTSL3 %>% 
  mutate(Reef_Site = "SCOTTSL3", Data_Type = "GCM") %>% 
  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

SCOTTSL3_Sat_Combined <- rbind(CCI_SCOTTSL3, NOAA_SCOTTSL3, GCM_SCOTTSL3)

ggplot(SCOTTSL3_Sat_Combined)+
  geom_rect(aes_string(xmin = as.Date(c("1997-06-01")), xmax = as.Date(c("1999-06-01")),
                ymin = -Inf, ymax = Inf), color = "maroon", fill = "transparent", alpha = 0.5)+
   geom_rect(aes_string(xmin = as.Date(c("2010-06-01")), xmax = as.Date(c("2012-06-01")),
                ymin = -Inf, ymax = Inf), color = "blue", fill = "transparent", alpha = 0.5)+
  geom_rect(aes_string(xmin = as.Date(c("2012-06-01")), xmax = as.Date(c("2014-06-01")),
                ymin = -Inf, ymax = Inf), color = "blue", fill = "transparent", alpha = 0.5)+
   geom_rect(aes_string(xmin = as.Date(c("2015-06-01")), xmax = as.Date(c("2017-06-01")),
                ymin = -Inf, ymax = Inf), color = "maroon", fill = "transparent", alpha = 0.5)+
  geom_line(aes(x = Date, y = accum_DHW_12weeks, color = Data_Type), alpha = 0.3, size = 2) +
  labs(x = "Time", y = "DHW value", title = "Time Series of SCOTTSL3 (-14.07, 121.78) Degree Heating Week values") +
  scale_color_discrete_qualitative(name = "Satellite") +
  scale_y_continuous(breaks = c(0, 4, 8, 12, 16, 20)) +
  theme(panel.grid.major.y = element_line(color = "grey", linetype = "dashed"),
        legend.key = element_rect(fill = "transparent"),
        plot.title = element_text( face = "bold")
  )


#ScottSS1
CCI_SCOTTSS1 <- CCI_SCOTTSS1 %>% 
  mutate(Reef_Site = "SCOTTSS1", Data_Type = "CCI") %>% 
  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

NOAA_SCOTTSS1 <- NOAA_SCOTTSS1 %>% 
  mutate(Data_Type = "NOAA", Reef_Site = subsite) %>% 
  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

GCM_SCOTTSS1 <- GCM_SCOTTSS1 %>% 
  mutate(Reef_Site = "SCOTTSS1", Data_Type = "GCM") %>% 
  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

SCOTTSS1_Sat_Combined <- rbind(CCI_SCOTTSS1, NOAA_SCOTTSS1, GCM_SCOTTSS1)

ggplot(SCOTTSS1_Sat_Combined)+
  geom_rect(aes_string(xmin = as.Date(c("1997-06-01")), xmax = as.Date(c("1999-06-01")),
                ymin = -Inf, ymax = Inf), color = "maroon", fill = "transparent", alpha = 0.5)+
   geom_rect(aes_string(xmin = as.Date(c("2010-06-01")), xmax = as.Date(c("2012-06-01")),
                ymin = -Inf, ymax = Inf), color = "blue", fill = "transparent", alpha = 0.5)+
  geom_rect(aes_string(xmin = as.Date(c("2012-06-01")), xmax = as.Date(c("2014-06-01")),
                ymin = -Inf, ymax = Inf), color = "blue", fill = "transparent", alpha = 0.5)+
   geom_rect(aes_string(xmin = as.Date(c("2015-06-01")), xmax = as.Date(c("2017-06-01")),
                ymin = -Inf, ymax = Inf), color = "maroon", fill = "transparent", alpha = 0.5)+
  geom_line(aes(x = Date, y = accum_DHW_12weeks, color = Data_Type), alpha = 0.3, size = 2) +
  labs(x = "Time", y = "DHW value", title = "Time Series of SCOTTSS1 (-14.08, 121.98) Degree Heating Week values") +
  scale_color_discrete_qualitative(name = "Satellite") +
  scale_y_continuous(breaks = c(0, 4, 8, 12, 16, 20)) +
  theme(panel.grid.major.y = element_line(color = "grey", linetype = "dashed"),
        legend.key = element_rect(fill = "transparent"),
        plot.title = element_text( face = "bold")
  )


#ScottSS2
CCI_SCOTTSS2 <- CCI_SCOTTSS2 %>% 
  mutate(Reef_Site = "SCOTTSS2", Data_Type = "CCI") %>% 
  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

NOAA_SCOTTSS2 <- NOAA_SCOTTSS2 %>% 
  mutate(Data_Type = "NOAA", Reef_Site = subsite) %>% 
  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

GCM_SCOTTSS2 <- GCM_SCOTTSS2 %>% 
  mutate(Reef_Site = "SCOTTSS2", Data_Type = "GCM") %>% 
  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

SCOTTSS2_Sat_Combined <- rbind(CCI_SCOTTSS2, NOAA_SCOTTSS2, GCM_SCOTTSS2)

ggplot(SCOTTSS2_Sat_Combined)+
  geom_rect(aes_string(xmin = as.Date(c("1997-06-01")), xmax = as.Date(c("1999-06-01")),
                ymin = -Inf, ymax = Inf), color = "maroon", fill = "transparent", alpha = 0.5)+
   geom_rect(aes_string(xmin = as.Date(c("2010-06-01")), xmax = as.Date(c("2012-06-01")),
                ymin = -Inf, ymax = Inf), color = "blue", fill = "transparent", alpha = 0.5)+
  geom_rect(aes_string(xmin = as.Date(c("2012-06-01")), xmax = as.Date(c("2014-06-01")),
                ymin = -Inf, ymax = Inf), color = "blue", fill = "transparent", alpha = 0.5)+
   geom_rect(aes_string(xmin = as.Date(c("2015-06-01")), xmax = as.Date(c("2017-06-01")),
                ymin = -Inf, ymax = Inf), color = "maroon", fill = "transparent", alpha = 0.5)+
  geom_line(aes(x = Date, y = accum_DHW_12weeks, color = Data_Type), alpha = 0.3, size = 2) +
  labs(x = "Time", y = "DHW value", title = "Time Series of SCOTTSS2 (-13.92, 121.92) Degree Heating Week values") +
  scale_color_discrete_qualitative(name = "Satellite") +
  scale_y_continuous(breaks = c(0, 4, 8, 12, 16, 20)) +
  theme(panel.grid.major.y = element_line(color = "grey", linetype = "dashed"),
        legend.key = element_rect(fill = "transparent"),
        plot.title = element_text( face = "bold")
  )


#Ningaloo BUN05A
CCI_BUN05A <- CCI_BUN05A %>% 
  mutate(Reef_Site = "BUN05A", Data_Type = "CCI") %>% 
  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

NOAA_BUN05A <- NOAA_BUN05A %>% 
  mutate(Data_Type = "NOAA") %>% 
  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

GCM_BUN05A <- GCM_BUN05A %>% 
  mutate(Reef_Site = "BUN05A", Data_Type = "GCM") %>% 
  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

BUN05A_Sat_Combined <- rbind(CCI_BUN05A, NOAA_BUN05A, GCM_BUN05A)

ggplot(BUN05A_Sat_Combined)+
   geom_rect(aes_string(xmin = as.Date(c("2010-06-01")), xmax = as.Date(c("2012-06-01")),
                ymin = -Inf, ymax = Inf), color = "maroon", fill = "transparent", alpha = 0.5)+
    geom_rect(aes_string(xmin = as.Date(c("2015-06-01")), xmax = as.Date(c("2017-06-01")),
                ymin = -Inf, ymax = Inf), color = "blue", fill = "transparent", alpha = 0.5)+
  geom_line(aes(x = Date, y = accum_DHW_12weeks, color = Data_Type), alpha = 0.3, size = 2) +
  labs(x = "Time", y = "DHW value", title = "Time Series of BUN05A (-21.84, 114.18) Degree Heating Week values") +
  scale_color_discrete_qualitative(name = "Satellite") +
  scale_y_continuous(breaks = c(0, 4, 8, 12, 16, 20)) +
  theme(panel.grid.major.y = element_line(color = "grey", linetype = "dashed"),
        legend.key = element_rect(fill = "transparent"),
        plot.title = element_text( face = "bold")
  )


#Ningaloo Bundegi
CCI_Bundegi <- CCI_Bundegi %>% 
  mutate(Reef_Site = "Bundegi", Data_Type = "CCI") %>% 
  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

NOAA_Bundegi <- NOAA_Bundegi %>% 
  mutate(Data_Type = "NOAA") %>% 
  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

GCM_Bundegi <- GCM_Bundegi %>% 
  mutate(Reef_Site = "Bundegi", Data_Type = "GCM") %>% 
  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

Bundegi_Sat_Combined <- rbind(CCI_Bundegi, NOAA_Bundegi, GCM_Bundegi)

ggplot(Bundegi_Sat_Combined)+
  geom_rect(aes_string(xmin = as.Date(c("2010-06-01")), xmax = as.Date(c("2012-06-01")),
                ymin = -Inf, ymax = Inf), color = "maroon", fill = "transparent", alpha = 0.5)+
    geom_rect(aes_string(xmin = as.Date(c("2015-06-01")), xmax = as.Date(c("2017-06-01")),
                ymin = -Inf, ymax = Inf), color = "blue", fill = "transparent", alpha = 0.5)+
  geom_line(aes(x = Date, y = accum_DHW_12weeks, color = Data_Type), alpha = 0.3, size = 2) +
  labs(x = "Time", y = "DHW value", title = "Time Series of 08BND and 13BND (-21.87, 114.16) Degree Heating Week values") +
  scale_color_discrete_qualitative(name = "Satellite") +
  scale_y_continuous(breaks = c(0, 4, 8, 12, 16, 20)) +
  theme(panel.grid.major.y = element_line(color = "grey", linetype = "dashed"),
        legend.key = element_rect(fill = "transparent"),
        plot.title = element_text( face = "bold")
  )


#Ningaloo Tantabiddi
CCI_Tantabiddi <- CCI_Tantabiddi %>% 
  mutate(Reef_Site = "Tantabiddi", Data_Type = "CCI") %>% 
  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

NOAA_Tantabiddi <- NOAA_Tantabiddi %>% 
  mutate(Data_Type = "NOAA") %>% 
  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

GCM_Tantabiddi <- GCM_Tantabiddi %>% 
  mutate(Reef_Site = "Tantabiddi", Data_Type = "GCM") %>% 
  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

Tantabiddi_Sat_Combined <- rbind(CCI_Tantabiddi, NOAA_Tantabiddi, GCM_Tantabiddi)

ggplot(Tantabiddi_Sat_Combined)+
  geom_rect(aes_string(xmin = as.Date(c("2010-06-01")), xmax = as.Date(c("2012-06-01")),
                ymin = -Inf, ymax = Inf), color = "maroon", fill = "transparent", alpha = 0.5)+
    geom_rect(aes_string(xmin = as.Date(c("2015-06-01")), xmax = as.Date(c("2017-06-01")),
                ymin = -Inf, ymax = Inf), color = "blue", fill = "transparent", alpha = 0.5)+
  geom_line(aes(x = Date, y = accum_DHW_12weeks, color = Data_Type), alpha = 0.3, size = 2) +
  labs(x = "Time", y = "DHW value", title = "Time Series of 08TNT and 13TNT (-21.91, 113.97) Degree Heating Week values") +
  scale_color_discrete_qualitative(name = "Satellite") +
  scale_y_continuous(breaks = c(0, 4, 8, 12, 16, 20)) +
  theme(panel.grid.major.y = element_line(color = "grey", linetype = "dashed"),
        legend.key = element_rect(fill = "transparent"),
        plot.title = element_text( face = "bold")
  )


#Ningaloo TNT
#CCI_TNT <- CCI_TNT %>% 
#  mutate(Reef_Site = "TNT", Data_Type = "CCI") %>% 
#  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

#NOAA_TNT <- NOAA_TNT %>% 
#  mutate(Data_Type = "NOAA") %>% 
#  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

#TNT_Sat_Combined <- rbind(CCI_TNT, NOAA_TNT)

#ggplot(TNT_Sat_Combined)+
#  geom_rect(aes_string(xmin = as.Date(c("2010-06-01")), xmax = as.Date(c("2012-06-01")),
#                ymin = -Inf, ymax = Inf), color = "maroon", fill = "transparent", alpha = 0.5)+
#    geom_rect(aes_string(xmin = as.Date(c("2015-06-01")), xmax = as.Date(c("2017-06-01")),
#                ymin = -Inf, ymax = Inf), color = "blue", fill = "transparent", alpha = 0.5)+
#  geom_line(aes(x = Date, y = accum_DHW_12weeks, color = Data_Type), alpha = 0.3, size = 2) +
#  labs(x = "Time", y = "DHW value", title = "Time Series of TNT (-21.9, 113.97) Degree Heating Week values") +
#  scale_color_discrete_qualitative(name = "Satellite") +
#  scale_y_continuous(breaks = c(0, 4, 8, 12, 16, 20)) +
#  theme(panel.grid.major.y = element_line(color = "grey", linetype = "dashed"),
#        legend.key = element_rect(fill = "transparent"),
#        plot.title = element_text( face = "bold")
#  )


#Ningaloo TNT07C
CCI_TNT07C <- CCI_TNT07C %>% 
  mutate(Reef_Site = "TNT07C", Data_Type = "CCI") %>% 
  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

NOAA_TNT07C <- NOAA_TNT07C %>% 
  mutate(Data_Type = "NOAA") %>% 
  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

GCM_TNT07C <- GCM_TNT07C %>% 
  mutate(Reef_Site = "TNT07C", Data_Type = "GCM") %>% 
  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

TNT07C_Sat_Combined <- rbind(CCI_TNT07C, NOAA_TNT07C, GCM_TNT07C)

ggplot(TNT07C_Sat_Combined)+
  geom_rect(aes_string(xmin = as.Date(c("2010-06-01")), xmax = as.Date(c("2012-06-01")),
                ymin = -Inf, ymax = Inf), color = "maroon", fill = "transparent", alpha = 0.5)+
    geom_rect(aes_string(xmin = as.Date(c("2015-06-01")), xmax = as.Date(c("2017-06-01")),
                ymin = -Inf, ymax = Inf), color = "blue", fill = "transparent", alpha = 0.5)+
  geom_line(aes(x = Date, y = accum_DHW_12weeks, color = Data_Type), alpha = 0.3, size = 2) +
  labs(x = "Time", y = "DHW value", title = "Time Series of TNT07C (-21.89, 113.96) Degree Heating Week values") +
  scale_color_discrete_qualitative(name = "Satellite") +
  scale_y_continuous(breaks = c(0, 4, 8, 12, 16, 20)) +
  theme(panel.grid.major.y = element_line(color = "grey", linetype = "dashed"),
        legend.key = element_rect(fill = "transparent"),
        plot.title = element_text( face = "bold")
  )


#Houtman Abrolhos Wallabi Island
#CCI_Wallabi_Island <- CCI_Wallabi_Island %>% 
#  mutate(Reef_Site = "Wallabi Island", Data_Type = "CCI") %>% 
#  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

#NOAA_Wallabi_Island <- NOAA_Wallabi_Island %>% 
#  mutate(Data_Type = "NOAA") %>% 
#  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

#Wallabi_Island_Sat_Combined <- rbind(CCI_Wallabi_Island, NOAA_Wallabi_Island)

#ggplot(Wallabi_Island_Sat_Combined)+
#  geom_rect(aes_string(xmin = as.Date(c("2010-06-01")), xmax = as.Date(c("2012-06-01")),
#                ymin = -Inf, ymax = Inf), color = "maroon", fill = "transparent", alpha = 0.5)+
#  geom_line(aes(x = Date, y = accum_DHW_12weeks, color = Data_Type), alpha = 0.3, size = 2) +
#  labs(x = "Time", y = "DHW value", title = "Time Series of Wallabi Island (-28.28, 113.46) Degree Heating Week values") +
#  scale_color_discrete_qualitative(name = "Satellite") +
#  scale_y_continuous(breaks = c(0, 4, 8, 12, 16, 20)) +
#  theme(panel.grid.major.y = element_line(color = "grey", linetype = "dashed"),
#        legend.key = element_rect(fill = "transparent"),
#        plot.title = element_text( face = "bold")
#  )


#Houtman Abrolhos HAB05B
CCI_HAB05B <- CCI_HAB05B %>% 
  mutate(Reef_Site = "HAB05B", Data_Type = "CCI") %>% 
  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

NOAA_HAB05B <- NOAA_HAB05B %>% 
  mutate(Data_Type = "NOAA") %>% 
  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

GCM_HAB05B <- GCM_HAB05B %>% 
  mutate(Reef_Site = "HAB05B", Data_Type = "GCM") %>% 
  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

HAB05B_Sat_Combined <- rbind(CCI_HAB05B, NOAA_HAB05B, GCM_HAB05B)

ggplot(HAB05B_Sat_Combined)+
  geom_rect(aes_string(xmin = as.Date(c("2010-06-01")), xmax = as.Date(c("2012-06-01")),
                ymin = -Inf, ymax = Inf), color = "maroon", fill = "transparent", alpha = 0.5)+
  geom_line(aes(x = Date, y = accum_DHW_12weeks, color = Data_Type), alpha = 0.3, size = 2) +
  labs(x = "Time", y = "DHW value", title = "Time Series of HAB05B (-28.46, 113.77) Degree Heating Week values") +
  scale_color_discrete_qualitative(name = "Satellite") +
  scale_y_continuous(breaks = c(0, 4, 8, 12, 16, 20)) +
  theme(panel.grid.major.y = element_line(color = "grey", linetype = "dashed"),
        legend.key = element_rect(fill = "transparent"),
        plot.title = element_text( face = "bold")
  )


#Houtman Abrolhos HAB10A
CCI_HAB10A <- CCI_HAB10A %>% 
  mutate(Reef_Site = "HAB10A", Data_Type = "CCI") %>% 
  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

NOAA_HAB10A <- NOAA_HAB10A %>% 
  mutate(Data_Type = "NOAA") %>% 
  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

GCM_HAB10A <- GCM_HAB10A %>% 
  mutate(Reef_Site = "HAB10A", Data_Type = "GCM") %>% 
  select(sst, Latitude, Longitude, Date, hotspot, degree_heating_week_mmm_from_sst, accum_DHW_12weeks, Reef_Site, Data_Type)

HAB10A_Sat_Combined <- rbind(CCI_HAB10A, NOAA_HAB10A, GCM_HAB10A)

ggplot(HAB10A_Sat_Combined)+
  geom_rect(aes_string(xmin = as.Date(c("2010-06-01")), xmax = as.Date(c("2012-06-01")),
                ymin = -Inf, ymax = Inf), color = "maroon", fill = "transparent", alpha = 0.5)+
  geom_line(aes(x = Date, y = accum_DHW_12weeks, color = Data_Type), alpha = 0.3, size = 2) +
  labs(x = "Time", y = "DHW value", title = "Time Series of HAB10A (-28.46, 113.75) Degree Heating Week values") +
  scale_color_discrete_qualitative(name = "Satellite") +
  scale_y_continuous(breaks = c(0, 4, 8, 12, 16, 20)) +
  theme(panel.grid.major.y = element_line(color = "grey", linetype = "dashed"),
        legend.key = element_rect(fill = "transparent"),
        plot.title = element_text( face = "bold")
  )


```



```{r Tables, echo = FALSE, message = FALSE, include = FALSE}

#BRS05
t_BRS05_Sat_Combined <- BRS05_Sat_Combined %>% 
  select(Date, accum_DHW_12weeks, Data_Type) %>% 
  filter(accum_DHW_12weeks >= 4) %>% 
  pivot_wider(names_from = Data_Type, values_from = accum_DHW_12weeks)
Max_BRS05 <- t_BRS05_Sat_Combined %>% 
  mutate(Year = year(Date), Month = month(Date), ) %>% 
  group_by(Year, Month) %>% 
  summarise(Max_DHW_month_CCI = as.numeric(mean(CCI)), Max_DHW_month_NOAA = as.numeric(mean(NOAA))) 

BRS05.color.me.CCI <- which(Max_BRS05$Max_DHW_month_CCI > 8)
BRS05.color.me.NOAA <- which(Max_BRS05$Max_DHW_month_NOAA > 8)

Max_BRS05 %>% 
  kbl(longtable = T, caption = "BRS05 Maximum Monthly Degree Heating Week values from CCI and NOAA") %>% 
  kable_styling(position = "center", latex_options = c("repeat_header")) %>% 
  row_spec(BRS05.color.me.CCI, color = "red") %>% 
  row_spec(BRS05.color.me.NOAA, color = "red")

  

#BRS07
t_BRS07_Sat_Combined <- BRS07_Sat_Combined %>% 
  select(Date, accum_DHW_12weeks, Data_Type) %>% 
  filter(accum_DHW_12weeks >= 4) %>% 
  pivot_wider(names_from = Data_Type, values_from = accum_DHW_12weeks)
Max_BRS07 <- t_BRS07_Sat_Combined %>% 
  mutate(Year = year(Date), Month = month(Date)) %>% 
  group_by(Year, Month) %>% 
  summarise(Max_DHW_month_CCI = mean(CCI), Max_DHW_month_NOAA = mean(NOAA)) %>%
  ungroup()

BRS07.color.me.CCI <- which(Max_BRS07$Max_DHW_month_CCI > 8)
BRS07.color.me.NOAA <- which(Max_BRS07$Max_DHW_month_NOAA > 8)

Max_BRS07 %>% 
kbl(longtable = T, caption = "BRS07 Maximum Monthly Degree Heating Week values from CCI and NOAA") %>% 
  kable_styling(position = "center", latex_options = c("repeat_header")) %>% 
  row_spec(BRS07.color.me.CCI, color = "red") %>% 
  row_spec(BRS07.color.me.NOAA, color = "red")


#DARL
t_DARL_Sat_Combined <- DARL_Sat_Combined %>% 
  select(Date, accum_DHW_12weeks, Data_Type) %>% 
  filter(accum_DHW_12weeks >= 4) %>% 
  pivot_wider(names_from = Data_Type, values_from = accum_DHW_12weeks)
Max_DARL <- t_DARL_Sat_Combined %>% 
  mutate(Year = year(Date), Month = month(Date)) %>% 
  group_by(Year, Month) %>% 
  summarise(Max_DHW_month_CCI = mean(CCI), Max_DHW_month_NOAA = mean(NOAA)) %>%
  ungroup()

DARL.color.me.CCI <- which(Max_DARL$Max_DHW_month_CCI > 8)
DARL.color.me.NOAA <- which(Max_DARL$Max_DHW_month_NOAA > 8)

Max_DARL %>% 
kbl(longtable = T, caption = "DAR Long Maximum Monthly Degree Heating Week values from CCI and NOAA") %>% 
  kable_styling(position = "center", latex_options = c("repeat_header")) %>% 
  row_spec(DARL.color.me.CCI, color = "red") %>% 
  row_spec(DARL.color.me.NOAA, color = "red")

#Tantabiddi
t_Tantabiddi_Sat_Combined <- Tantabiddi_Sat_Combined %>% 
  select(Date, accum_DHW_12weeks, Data_Type) %>% 
  filter(accum_DHW_12weeks >= 4) %>% 
  pivot_wider(names_from = Data_Type, values_from = accum_DHW_12weeks)
Max_Tantabiddi <- t_Tantabiddi_Sat_Combined %>% 
  mutate(Year = year(Date), Month = month(Date)) %>% 
  group_by(Year, Month) %>% 
  summarise(Max_DHW_month_CCI = mean(CCI), Max_DHW_month_NOAA = mean(NOAA)) %>%
  ungroup()

T.color.me.CCI <- which(Max_Tantabiddi$Max_DHW_month_CCI > 8)
T.color.me.NOAA <- which(Max_Tantabiddi$Max_DHW_month_NOAA > 8)

Max_Tantabiddi %>% 
kbl(longtable = T, caption = "13TNT and 08TNT Maximum Monthly Degree Heating Week values from CCI and NOAA") %>% 
  kable_styling(position = "center", latex_options = c("repeat_header")) %>% 
  row_spec(T.color.me.CCI, color = "red") %>% 
  row_spec(T.color.me.NOAA, color = "red")


#TNT
#t_TNT_Sat_Combined <- TNT_Sat_Combined %>% 
#  select(Date, accum_DHW_12weeks, Data_Type) %>% 
#  filter(accum_DHW_12weeks >= 4) %>% 
#  pivot_wider(names_from = Data_Type, values_from = accum_DHW_12weeks)
#Max_TNT <- t_TNT_Sat_Combined %>% 
#  mutate(Year = year(Date), Month = month(Date)) %>% 
#  group_by(Year, Month) %>% 
#  summarise(Max_DHW_month_CCI = mean(CCI), Max_DHW_month_NOAA = mean(NOAA)) %>%
#  ungroup()

#TNT.color.me.CCI <- which(Max_TNT$Max_DHW_month_CCI > 8)
#TNT.color.me.NOAA <- which(Max_TNT$Max_DHW_month_NOAA > 8)

#Max_TNT %>% 
#kbl(longtable = T, caption = "TNT Maximum Monthly Degree Heating Week values from CCI and NOAA") %>% 
#  kable_styling(position = "center", latex_options = c("repeat_header")) %>% 
#  row_spec(TNT.color.me.CCI, color = "red") %>% 
#  row_spec(TNT.color.me.NOAA, color = "red")

#Wallabi Island
#t_Wallabi_Island_Sat_Combined <- Wallabi_Island_Sat_Combined %>% 
#  select(Date, accum_DHW_12weeks, Data_Type) %>% 
#  filter(accum_DHW_12weeks >= 4) %>% 
#  pivot_wider(names_from = Data_Type, values_from = accum_DHW_12weeks)
#Max_Wallabi_Island <- t_Wallabi_Island_Sat_Combined %>% 
#  mutate(Year = year(Date), Month = month(Date)) %>% 
#  group_by(Year, Month) %>% 
#  summarise(Max_DHW_month_CCI = mean(CCI), Max_DHW_month_NOAA = mean(NOAA)) %>%
#  ungroup()

#W.color.me.CCI <- which(Max_Wallabi_Island$Max_DHW_month_CCI > 8)
#W.color.me.NOAA <- which(Max_Wallabi_Island$Max_DHW_month_NOAA > 8)

#Max_Wallabi_Island %>% 
#kbl(longtable = T, caption = "Wallabi Island Maximum Monthly Degree Heating Week values from CCI and NOAA") %>% 
#  kable_styling(position = "center", latex_options = c("repeat_header")) %>% 
#  row_spec(W.color.me.CCI, color = "red") %>% 
#  row_spec(W.color.me.NOAA, color = "red")

```


